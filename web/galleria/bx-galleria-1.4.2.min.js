(function(w,D,N,q){var c=D.document,L=w(c),u=w(D),O=Array.prototype,m=1.41,v=true,l=30000,j=false,I=navigator.userAgent.toLowerCase(),e=D.location.hash.replace(/#\//,""),x=D.location.protocol,f=Math,i=function(){},K=function(){return false},o=(function(){var F=3,P=c.createElement("div"),M=P.getElementsByTagName("i");do{P.innerHTML="<!--[if gt IE "+(++F)+"]><i></i><![endif]-->"}while(M[0]);return F>4?F:c.documentMode||q}()),r=function(){return{html:c.documentElement,body:c.body,head:c.getElementsByTagName("head")[0],title:c.title}},G=D.parent!==D.self,y="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",z=(function(){var F=[];w.each(y.split(" "),function(M,P){F.push(P);if(/_/.test(P)){F.push(P.replace(/_/g,""))}});return F}()),t=function(F){var M;if(typeof F!=="object"){return F}w.each(F,function(P,Q){if(/^[a-z]+_/.test(P)){M="";w.each(P.split("_"),function(S,R){M+=S>0?R.substr(0,1).toUpperCase()+R.substr(1):R});F[M]=Q;delete F[P]}});return F},H=function(F){if(w.inArray(F,z)>-1){return N[F.toUpperCase()]}return F},b={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(){return"http://www.youtube.com/embed/"+this.id},getUrl:function(){return x+"//gdata.youtube.com/feeds/api/videos/"+this.id+"?v=2&alt=json-in-script&callback=?"},get_thumb:function(F){return F.entry.media$group.media$thumbnail[2].url},get_image:function(F){if(F.entry.yt$hd){return x+"//img.youtube.com/vi/"+this.id+"/maxresdefault.jpg"}return F.entry.media$group.media$thumbnail[3].url}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(){return"http://player.vimeo.com/video/"+this.id},getUrl:function(){return x+"//vimeo.com/api/v2/video/"+this.id+".json?callback=?"},get_thumb:function(F){return F[0].thumbnail_medium},get_image:function(F){return F[0].thumbnail_large}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(){return x+"//www.dailymotion.com/embed/video/"+this.id},getUrl:function(){return"https://api.dailymotion.com/video/"+this.id+"?fields=thumbnail_240_url,thumbnail_720_url&callback=?"},get_thumb:function(F){return F.thumbnail_240_url},get_image:function(F){return F.thumbnail_720_url}},_inst:[]},J=function(P,Q){for(var M=0;M<b._inst.length;M++){if(b._inst[M].id===Q&&b._inst[M].type==P){return b._inst[M]}}this.type=P;this.id=Q;this.readys=[];b._inst.push(this);var F=this;w.extend(this,b[P]);w.getJSON(this.getUrl(),function(R){F.data=R;w.each(F.readys,function(S,T){T(F.data)});F.readys=[]});this.getMedia=function(T,W,R){R=R||i;var S=this;var V=function(X){W(S["get_"+T](X))};try{if(S.data){V(S.data)}else{S.readys.push(V)}}catch(U){R()}}},h=function(P){var M;for(var F in b){M=P&&b[F].reg&&P.match(b[F].reg);if(M&&M.length){return{id:M[2],provider:F}}}return false},d={support:(function(){var F=r().html;return !G&&(F.requestFullscreen||F.msRequestFullscreen||F.mozRequestFullScreen||F.webkitRequestFullScreen)}()),callback:i,enter:function(F,P,M){this.instance=F;this.callback=P||i;M=M||r().html;if(M.requestFullscreen){M.requestFullscreen()}else{if(M.msRequestFullscreen){M.msRequestFullscreen()}else{if(M.mozRequestFullScreen){M.mozRequestFullScreen()}else{if(M.webkitRequestFullScreen){M.webkitRequestFullScreen()}}}}},exit:function(F){this.callback=F||i;if(c.exitFullscreen){c.exitFullscreen()}else{if(c.msExitFullscreen){c.msExitFullscreen()}else{if(c.mozCancelFullScreen){c.mozCancelFullScreen()}else{if(c.webkitCancelFullScreen){c.webkitCancelFullScreen()}}}}},instance:null,listen:function(){if(!this.support){return}var F=function(){if(!d.instance){return}var M=d.instance._fullscreen;if(c.fullscreen||c.mozFullScreen||c.webkitIsFullScreen||(c.msFullscreenElement&&c.msFullscreenElement!==null)){M._enter(d.callback)}else{M._exit(d.callback)}};c.addEventListener("fullscreenchange",F,false);c.addEventListener("MSFullscreenChange",F,false);c.addEventListener("mozfullscreenchange",F,false);c.addEventListener("webkitfullscreenchange",F,false)}},a=[],g=[],p=false,n=false,C=[],A=[],E=function(F){A.push(F);w.each(C,function(P,M){if(M._options.theme==F.name||(!M._initialized&&!M._options.theme)){M.theme=F;M._init.call(M)}})},B=(function(){return{clearTimer:function(F){w.each(N.get(),function(){this.clearTimer(F)})},addTimer:function(F){w.each(N.get(),function(){this.addTimer(F)})},array:function(F){return O.slice.call(F,0)},create:function(F,P){P=P||"div";var M=c.createElement(P);M.className=F;return M},removeFromArray:function(F,M){w.each(F,function(P,Q){if(Q==M){F.splice(P,1);return false}});return F},getScriptPath:function(M){M=M||w("script:last").attr("src");var F=M.split("/");if(F.length==1){return""}F.pop();return F.join("/")+"/"},animate:(function(){var U=(function(ab){var aa="transition WebkitTransition MozTransition OTransition".split(" "),Z;if(D.opera){return false}for(Z=0;aa[Z];Z++){if(typeof ab[aa[Z]]!=="undefined"){return aa[Z]}}return false}((c.body||c.documentElement).style));var Y={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[U];var P={_default:[0.25,0.1,0.25,1],galleria:[0.645,0.045,0.355,1],galleriaIn:[0.55,0.085,0.68,0.53],galleriaOut:[0.25,0.46,0.45,0.94],ease:[0.25,0,0.25,1],linear:[0.25,0.25,0.75,0.75],"ease-in":[0.42,0,1,1],"ease-out":[0,0,0.58,1],"ease-in-out":[0.42,0,0.58,1]};var R=function(aa,ab,ac){var Z={};ac=ac||"transition";w.each("webkit moz ms o".split(" "),function(){Z["-"+this+"-"+ac]=ab});aa.css(Z)};var V=function(Z){R(Z,"none","transition");if(N.WEBKIT&&N.TOUCH){R(Z,"translate3d(0,0,0)","transform");if(Z.data("revert")){Z.css(Z.data("revert"));Z.data("revert",null)}}};var W,X,T,M,S,F,Q;return function(aa,ab,Z){Z=w.extend({duration:400,complete:i,stop:false},Z);aa=w(aa);if(!Z.duration){aa.css(ab);Z.complete.call(aa[0]);return}if(!U){aa.animate(ab,Z);return}if(Z.stop){aa.off(Y);V(aa)}W=false;w.each(ab,function(ac,ad){Q=aa.css(ac);if(B.parseValue(Q)!=B.parseValue(ad)){W=true}aa.css(ac,Q)});if(!W){D.setTimeout(function(){Z.complete.call(aa[0])},Z.duration);return}X=[];T=Z.easing in P?P[Z.easing]:P._default;M=" "+Z.duration+"ms cubic-bezier("+T.join(",")+")";D.setTimeout((function(ad,af,ae,ac){return function(){ad.one(af,(function(ag){return function(){V(ag);Z.complete.call(ag[0])}}(ad)));if(N.WEBKIT&&N.TOUCH){S={};F=[0,0,0];w.each(["left","top"],function(ah,ag){if(ag in ae){F[ah]=(B.parseValue(ae[ag])-B.parseValue(ad.css(ag)))+"px";S[ag]=ae[ag];delete ae[ag]}});if(F[0]||F[1]){ad.data("revert",S);X.push("-webkit-transform"+ac);R(ad,"translate3d("+F.join(",")+")","transform")}}w.each(ae,function(ag,ah){X.push(ag+ac)});R(ad,X.join(","));ad.css(ae)}}(aa,Y,ab,M)),2)}}()),removeAlpha:function(Q){if(Q instanceof jQuery){Q=Q[0]}if(o<9&&Q){var P=Q.style,F=Q.currentStyle,M=F&&F.filter||P.filter||"";if(/alpha/.test(M)){P.filter=M.replace(/alpha\([^)]*\)/i,"")}}},forceStyles:function(M,F){M=w(M);if(M.attr("style")){M.data("styles",M.attr("style")).removeAttr("style")}M.css(F)},revertStyles:function(){w.each(B.array(arguments),function(F,M){M=w(M);M.removeAttr("style");M.attr("style","");if(M.data("styles")){M.attr("style",M.data("styles")).data("styles",null)}})},moveOut:function(F){B.forceStyles(F,{position:"absolute",left:-10000})},moveIn:function(){B.revertStyles.apply(B,B.array(arguments))},hide:function(Q,R,S){S=S||i;var M=w(Q);Q=M[0];if(!M.data("opacity")){M.data("opacity",M.css("opacity"))}var P={opacity:0};if(R){var F=o<9&&Q?function(){B.removeAlpha(Q);Q.style.visibility="hidden";S.call(Q)}:S;B.animate(Q,P,{duration:R,complete:F,stop:true})}else{if(o<9&&Q){B.removeAlpha(Q);Q.style.visibility="hidden"}else{M.css(P)}}},show:function(R,S,T){T=T||i;var M=w(R);R=M[0];var Q=parseFloat(M.data("opacity"))||1,P={opacity:Q};if(S){if(o<9){M.css("opacity",0);R.style.visibility="visible"}var F=o<9&&R?function(){if(P.opacity==1){B.removeAlpha(R)}T.call(R)}:T;B.animate(R,P,{duration:S,complete:F,stop:true})}else{if(o<9&&P.opacity==1&&R){B.removeAlpha(R);R.style.visibility="visible"}else{M.css(P)}}},wait:function(P){N._waiters=N._waiters||[];P=w.extend({until:K,success:i,error:function(){N.raise("Could not complete wait function.")},timeout:3000},P);var S=B.timestamp(),F,M,R,Q=function(){M=B.timestamp();F=M-S;B.removeFromArray(N._waiters,R);if(P.until(F)){P.success();return false}if(typeof P.timeout=="number"&&M>=S+P.timeout){P.error();return false}N._waiters.push(R=D.setTimeout(Q,10))};N._waiters.push(R=D.setTimeout(Q,10))},toggleQuality:function(F,M){if((o!==7&&o!==8)||!F||F.nodeName.toUpperCase()!="IMG"){return}if(typeof M==="undefined"){M=F.style.msInterpolationMode==="nearest-neighbor"}F.style.msInterpolationMode=M?"bicubic":"nearest-neighbor"},insertStyleTag:function(P,Q){if(Q&&w("#"+Q).length){return}var M=c.createElement("style");if(Q){M.id=Q}r().head.appendChild(M);if(M.styleSheet){M.styleSheet.cssText=P}else{var F=c.createTextNode(P);M.appendChild(F)}},loadScript:function(P,Q){var F=false,M=w("<script>").attr({src:P,async:true}).get(0);M.onload=M.onreadystatechange=function(){if(!F&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){F=true;M.onload=M.onreadystatechange=null;if(typeof Q==="function"){Q.call(this,this)}}};r().head.appendChild(M)},parseValue:function(M){if(typeof M==="number"){return M}else{if(typeof M==="string"){var F=M.match(/\-?\d|\./g);return F&&F.constructor===Array?F.join("")*1:0}else{return 0}}},timestamp:function(){return new Date().getTime()},loadCSS:function(F,T,S){var R,Q;w("link[rel=stylesheet]").each(function(){if(new RegExp(F).test(this.href)){R=this;return false}});if(typeof T==="function"){S=T;T=q}S=S||i;if(R){S.call(R,R);return R}Q=c.styleSheets.length;if(w("#"+T).length){w("#"+T).attr("href",F);Q--}else{R=w("<link>").attr({rel:"stylesheet",href:F,id:T}).get(0);var P=w('link[rel="stylesheet"], style');if(P.length){P.get(0).parentNode.insertBefore(R,P[0])}else{r().head.appendChild(R)}if(o&&Q>=31){N.raise("You have reached the browser stylesheet limit (31)",true);return}}if(typeof S==="function"){var M=w("<s>").attr("id","galleria-loader").hide().appendTo(r().body);B.wait({until:function(){return M.height()==1},success:function(){M.remove();S.call(R,R)},error:function(){M.remove();N.raise("Theme CSS could not load after 20 sec. "+(N.QUIRK?"Your browser is in Quirks Mode, please add a correct doctype.":"Please download the latest theme at http://galleria.io/customer/."),true)},timeout:20000})}return R}}}()),s=function(F){var M=".galleria-videoicon{width:60px;height:60px;position:absolute;top:50%;left:50%;z-index:1;margin:-30px 0 0 -30px;cursor:pointer;background:#000;background:rgba(0,0,0,.8);border-radius:3px;-webkit-transition:all 150ms}.galleria-videoicon i{width:0px;height:0px;border-style:solid;border-width:10px 0 10px 16px;display:block;border-color:transparent transparent transparent #ffffff;margin:20px 0 0 22px}.galleria-image:hover .galleria-videoicon{background:#000}";B.insertStyleTag(M,"galleria-videoicon");return w(B.create("galleria-videoicon")).html("<i></i>").appendTo(F).click(function(){w(this).siblings("img").mouseup()})},k=(function(){var F=function(R,P,Q,M){var V=this.getOptions("easing"),U=this.getStageWidth(),T={left:U*(R.rewind?-1:1)},S={left:0};if(Q){T.opacity=0;S.opacity=1}else{T.opacity=1}w(R.next).css(T);B.animate(R.next,S,{duration:R.speed,complete:(function(W){return function(){P();W.css({left:0})}}(w(R.next).add(R.prev))),queue:false,easing:V});if(M){R.rewind=!R.rewind}if(R.prev){T={left:0};S={left:U*(R.rewind?1:-1)};if(Q){T.opacity=1;S.opacity=0}w(R.prev).css(T);B.animate(R.prev,S,{duration:R.speed,queue:false,easing:V,complete:function(){w(this).css("opacity",0)}})}};return{active:false,init:function(P,Q,M){if(k.effects.hasOwnProperty(P)){k.effects[P].call(this,Q,M)}},effects:{fade:function(P,M){w(P.next).css({opacity:0,left:0});B.animate(P.next,{opacity:1},{duration:P.speed,complete:M});if(P.prev){w(P.prev).css("opacity",1).show();B.animate(P.prev,{opacity:0},{duration:P.speed})}},flash:function(P,M){w(P.next).css({opacity:0,left:0});if(P.prev){B.animate(P.prev,{opacity:0},{duration:P.speed/2,complete:function(){B.animate(P.next,{opacity:1},{duration:P.speed,complete:M})}})}else{B.animate(P.next,{opacity:1},{duration:P.speed,complete:M})}},pulse:function(P,M){if(P.prev){w(P.prev).hide()}w(P.next).css({opacity:0,left:0}).show();B.animate(P.next,{opacity:1},{duration:P.speed,complete:M})},slide:function(P,M){F.apply(this,B.array(arguments))},fadeslide:function(P,M){F.apply(this,B.array(arguments).concat([true]))},doorslide:function(P,M){F.apply(this,B.array(arguments).concat([false,true]))}}}}());d.listen();w.event.special["click:fast"]={propagate:true,add:function(F){var M=function(Q){if(Q.touches&&Q.touches.length){var R=Q.touches[0];return{x:R.pageX,y:R.pageY}}};var P={touched:false,touchdown:false,coords:{x:0,y:0},evObj:{}};w(this).data({clickstate:P,timer:0}).on("touchstart.fast",function(Q){D.clearTimeout(w(this).data("timer"));w(this).data("clickstate",{touched:true,touchdown:true,coords:M(Q.originalEvent),evObj:Q})}).on("touchmove.fast",function(S){var R=M(S.originalEvent),Q=w(this).data("clickstate"),T=Math.max(Math.abs(Q.coords.x-R.x),Math.abs(Q.coords.y-R.y));if(T>6){w(this).data("clickstate",w.extend(Q,{touchdown:false}))}}).on("touchend.fast",function(S){var R=w(this),Q=R.data("clickstate");if(Q.touchdown){F.handler.call(this,S)}R.data("timer",D.setTimeout(function(){R.data("clickstate",P)},400))}).on("click.fast",function(R){var Q=w(this).data("clickstate");if(Q.touched){return false}w(this).data("clickstate",P);F.handler.call(this,R)})},remove:function(){w(this).off("touchstart.fast touchmove.fast touchend.fast click.fast")}};u.on("orientationchange",function(){w(this).resize()});N=function(){var W=this;this._options={};this._playing=false;this._playtime=5000;this._active=null;this._queue={length:0};this._data=[];this._dom={};this._thumbnails=[];this._layers=[];this._initialized=false;this._firstrun=false;this._stageWidth=0;this._stageHeight=0;this._target=q;this._binds=[];this._id=parseInt(f.random()*10000,10);var S="container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip",R="current total";w.each(S.split(" "),function(Y,Z){W._dom[Z]=B.create("galleria-"+Z)});w.each(R.split(" "),function(Y,Z){W._dom[Z]=B.create("galleria-"+Z,"span")});var Q=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:false,press:function(Z){var Y=Z.keyCode||Z.which;if(Y in Q.map&&typeof Q.map[Y]==="function"){Q.map[Y].call(W,Z)}},attach:function(aa){var Z,Y;for(Z in aa){if(aa.hasOwnProperty(Z)){Y=Z.toUpperCase();if(Y in Q.keys){Q.map[Q.keys[Y]]=aa[Z]}else{Q.map[Y]=aa[Z]}}}if(!Q.bound){Q.bound=true;L.on("keydown",Q.press)}},detach:function(){Q.bound=false;Q.map={};L.off("keydown",Q.press)}};var U=this._controls={0:q,1:q,active:0,swap:function(){U.active=U.active?0:1},getActive:function(){return W._options.swipe?U.slides[W._active]:U[U.active]},getNext:function(){return W._options.swipe?U.slides[W.getNext(W._active)]:U[1-U.active]},slides:[],frames:[],layers:[]};var V=this._carousel={next:W.$("thumb-nav-right"),prev:W.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var Z=0,aa=0,Y=[0];w.each(W._thumbnails,function(ac,ab){if(ab.ready){Z+=ab.outerWidth||w(ab.container).outerWidth(true);var ad=w(ab.container).width();Z+=ad-f.floor(ad);Y[ac+1]=Z;aa=f.max(aa,ab.outerHeight||w(ab.container).outerHeight(true))}});W.$("thumbnails").css({width:Z,height:aa});V.max=Z;V.hooks=Y;V.width=W.$("thumbnails-list").width();V.setClasses();W.$("thumbnails-container").toggleClass("galleria-carousel",Z>V.width);V.width=W.$("thumbnails-list").width()},bindControls:function(){var Y;V.next.on("click:fast",function(Z){Z.preventDefault();if(W._options.carouselSteps==="auto"){for(Y=V.current;Y<V.hooks.length;Y++){if(V.hooks[Y]-V.hooks[V.current]>V.width){V.set(Y-2);break}}}else{V.set(V.current+W._options.carouselSteps)}});V.prev.on("click:fast",function(Z){Z.preventDefault();if(W._options.carouselSteps==="auto"){for(Y=V.current;Y>=0;Y--){if(V.hooks[V.current]-V.hooks[Y]>V.width){V.set(Y+2);break}else{if(Y===0){V.set(0);break}}}}else{V.set(V.current-W._options.carouselSteps)}})},set:function(Y){Y=f.max(Y,0);while(V.hooks[Y-1]+V.width>=V.max&&Y>=0){Y--}V.current=Y;V.animate()},getLast:function(Y){return(Y||V.current)-1},follow:function(Y){if(Y===0||Y===V.hooks.length-2){V.set(Y);return}var Z=V.current;while(V.hooks[Z]-V.hooks[V.current]<V.width&&Z<=V.hooks.length){Z++}if(Y-1<V.current){V.set(Y-1)}else{if(Y+2>Z){V.set(Y-Z+V.current+2)}}},setClasses:function(){V.prev.toggleClass("disabled",!V.current);V.next.toggleClass("disabled",V.hooks[V.current]+V.width>=V.max)},animate:function(Z){V.setClasses();var Y=V.hooks[V.current]*-1;if(isNaN(Y)){return}W.$("thumbnails").css("left",function(){return w(this).css("left")});B.animate(W.get("thumbnails"),{left:Y},{duration:W._options.carouselSpeed,easing:W._options.easing,queue:false})}};var X=this._tooltip={initialized:false,open:false,timer:"tooltip"+W._id,swapTimer:"swap"+W._id,init:function(){X.initialized=true;var Y=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";B.insertStyleTag(Y,"galleria-tooltip");W.$("tooltip").css({opacity:0.8,visibility:"visible",display:"none"})},move:function(af){var ae=W.getMousePosition(af).x,ad=W.getMousePosition(af).y,ab=W.$("tooltip"),ah=ae,ag=ad,ai=ab.outerHeight(true)+1,aa=ab.outerWidth(true),ac=ai+15;var Z=W.$("container").width()-aa-2,Y=W.$("container").height()-ai-2;if(!isNaN(ah)&&!isNaN(ag)){ah+=10;ag-=(ai+8);ah=f.max(0,f.min(Z,ah));ag=f.max(0,f.min(Y,ag));if(ad<ac){ag=ac}ab.css({left:ah,top:ag})}},bind:function(Z,aa){if(N.TOUCH){return}if(!X.initialized){X.init()}var ab=function(){W.$("container").off("mousemove",X.move);W.clearTimer(X.timer);W.$("tooltip").stop().animate({opacity:0},200,function(){W.$("tooltip").hide();W.addTimer(X.swapTimer,function(){X.open=false},1000)})};var Y=function(ac,ad){X.define(ac,ad);w(ac).hover(function(){W.clearTimer(X.swapTimer);W.$("container").off("mousemove",X.move).on("mousemove",X.move).trigger("mousemove");X.show(ac);W.addTimer(X.timer,function(){W.$("tooltip").stop().show().animate({opacity:1});X.open=true},X.open?0:500)},ab).click(ab)};if(typeof aa==="string"){Y((Z in W._dom?W.get(Z):Z),aa)}else{w.each(Z,function(ac,ad){Y(W.get(ac),ad)})}},show:function(Y){Y=w(Y in W._dom?W.get(Y):Y);var aa=Y.data("tt"),Z=function(ab){D.setTimeout((function(ac){return function(){X.move(ac)}}(ab)),10);Y.off("mouseup",Z)};aa=typeof aa==="function"?aa():aa;if(!aa){return}W.$("tooltip").html(aa.replace(/\s/,"&#160;"));Y.on("mouseup",Z)},define:function(Z,aa){if(typeof aa!=="function"){var Y=aa;aa=function(){return Y}}Z=w(Z in W._dom?W.get(Z):Z).data("tt",aa);X.show(Z)}};var T=this._fullscreen={scrolled:0,crop:q,active:false,prev:w(),beforeEnter:function(Y){Y()},beforeExit:function(Y){Y()},keymap:W._keyboard.map,parseCallback:function(Z,Y){return k.active?function(){if(typeof Z=="function"){Z.call(W)}var ab=W._controls.getActive(),aa=W._controls.getNext();W._scaleImage(aa);W._scaleImage(ab);if(Y&&W._options.trueFullscreen){w(ab.container).add(aa.container).trigger("transitionend")}}:Z},enter:function(Y){T.beforeEnter(function(){Y=T.parseCallback(Y,true);if(W._options.trueFullscreen&&d.support){T.active=true;B.forceStyles(W.get("container"),{width:"100%",height:"100%"});W.rescale();if(N.MAC){if(!(N.SAFARI&&/version\/[1-5]/.test(I))){W.$("container").css("opacity",0).addClass("fullscreen");D.setTimeout(function(){T.scale();W.$("container").css("opacity",1)},50)}else{W.$("stage").css("opacity",0);D.setTimeout(function(){T.scale();W.$("stage").css("opacity",1)},4)}}else{W.$("container").addClass("fullscreen")}u.resize(T.scale);d.enter(W,Y,W.get("container"))}else{T.scrolled=u.scrollTop();if(!N.TOUCH){D.scrollTo(0,0)}T._enter(Y)}})},_enter:function(ai){T.active=true;if(G){T.iframe=(function(){var al,ak=c.referrer,an=c.createElement("a"),am=D.location;an.href=ak;if(an.protocol!=am.protocol||an.hostname!=am.hostname||an.port!=am.port){N.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match.");return false}T.pd=D.parent.document;w(T.pd).find("iframe").each(function(){var ao=this.contentDocument||this.contentWindow.document;if(ao===c){al=this;return false}});return al}())}B.hide(W.getActiveImage());if(G&&T.iframe){T.iframe.scrolled=w(D.parent).scrollTop();D.parent.scrollTo(0,0)}var ad=W.getData(),aj=W._options,af=!W._options.trueFullscreen||!d.support,ag={height:"100%",overflow:"hidden",margin:0,padding:0};if(af){W.$("container").addClass("fullscreen");T.prev=W.$("container").prev();if(!T.prev.length){T.parent=W.$("container").parent()}W.$("container").appendTo("body");B.forceStyles(W.get("container"),{position:N.TOUCH?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:10000});B.forceStyles(r().html,ag);B.forceStyles(r().body,ag)}if(G&&T.iframe){B.forceStyles(T.pd.documentElement,ag);B.forceStyles(T.pd.body,ag);B.forceStyles(T.iframe,w.extend(ag,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:10000,border:"none"}))}T.keymap=w.extend({},W._keyboard.map);W.attachKeyboard({escape:W.exitFullscreen,right:W.next,left:W.prev});T.crop=aj.imageCrop;if(aj.fullscreenCrop!=q){aj.imageCrop=aj.fullscreenCrop}if(ad&&ad.big&&ad.image!==ad.big){var ac=new N.Picture(),ab=ac.isCached(ad.big),ae=W.getIndex(),Y=W._thumbnails[ae];W.trigger({type:N.LOADSTART,cached:ab,rewind:false,index:ae,imageTarget:W.getActiveImage(),thumbTarget:Y,galleriaData:ad});ac.load(ad.big,function(ak){W._scaleImage(ak,{complete:function(al){W.trigger({type:N.LOADFINISH,cached:ab,index:ae,rewind:false,imageTarget:al.image,thumbTarget:Y});var am=W._controls.getActive().image;if(am){w(am).width(al.image.width).height(al.image.height).attr("style",w(al.image).attr("style")).attr("src",al.image.src)}}})});var aa=W.getNext(ae),Z=new N.Picture(),ah=W.getData(aa);Z.preload(W.isFullscreen()&&ah.big?ah.big:ah.image)}W.rescale(function(){W.addTimer(false,function(){if(af){B.show(W.getActiveImage())}if(typeof ai==="function"){ai.call(W)}W.rescale()},100);W.trigger(N.FULLSCREEN_ENTER)});if(!af){B.show(W.getActiveImage())}else{u.resize(T.scale)}},scale:function(){W.rescale()},exit:function(Y){T.beforeExit(function(){Y=T.parseCallback(Y);if(W._options.trueFullscreen&&d.support){d.exit(Y)}else{T._exit(Y)}})},_exit:function(ad){T.active=false;var Z=!W._options.trueFullscreen||!d.support,ac=W.$("container").removeClass("fullscreen");if(T.parent){T.parent.prepend(ac)}else{ac.insertAfter(T.prev)}if(Z){B.hide(W.getActiveImage());B.revertStyles(W.get("container"),r().html,r().body);if(!N.TOUCH){D.scrollTo(0,T.scrolled)}var ab=W._controls.frames[W._controls.active];if(ab&&ab.image){ab.image.src=ab.image.src}}if(G&&T.iframe){B.revertStyles(T.pd.documentElement,T.pd.body,T.iframe);if(T.iframe.scrolled){D.parent.scrollTo(0,T.iframe.scrolled)}}W.detachKeyboard();W.attachKeyboard(T.keymap);W._options.imageCrop=T.crop;var Y=W.getData().big,aa=W._controls.getActive().image;if(!W.getData().iframe&&aa&&Y&&Y==aa.src){D.setTimeout(function(ae){return function(){aa.src=ae}}(W.getData().image),1)}W.rescale(function(){W.addTimer(false,function(){if(Z){B.show(W.getActiveImage())}if(typeof ad==="function"){ad.call(W)}u.trigger("resize")},50);W.trigger(N.FULLSCREEN_EXIT)});u.off("resize",T.scale)}};var P=this._idle={trunk:[],bound:false,active:false,add:function(ab,ad,ac,Y){if(!ab||N.TOUCH){return}if(!P.bound){P.addEvent()}ab=w(ab);if(typeof ac=="boolean"){Y=ac;ac={}}ac=ac||{};var aa={},Z;for(Z in ad){if(ad.hasOwnProperty(Z)){aa[Z]=ab.css(Z)}}ab.data("idle",{from:w.extend(aa,ac),to:ad,complete:true,busy:false});if(!Y){P.addTimer()}else{ab.css(ad)}P.trunk.push(ab)},remove:function(Y){Y=w(Y);w.each(P.trunk,function(Z,aa){if(aa&&aa.length&&!aa.not(Y).length){Y.css(Y.data("idle").from);P.trunk.splice(Z,1)}});if(!P.trunk.length){P.removeEvent();W.clearTimer(P.timer)}},addEvent:function(){P.bound=true;W.$("container").on("mousemove click",P.showAll);if(W._options.idleMode=="hover"){W.$("container").on("mouseleave",P.hide)}},removeEvent:function(){P.bound=false;W.$("container").on("mousemove click",P.showAll);if(W._options.idleMode=="hover"){W.$("container").off("mouseleave",P.hide)}},addTimer:function(){if(W._options.idleMode=="hover"){return}W.addTimer("idle",function(){P.hide()},W._options.idleTime)},hide:function(){if(!W._options.idleMode||W.getIndex()===false){return}W.trigger(N.IDLE_ENTER);var Y=P.trunk.length;w.each(P.trunk,function(Z,aa){var ab=aa.data("idle");if(!ab){return}aa.data("idle").complete=false;B.animate(aa,ab.to,{duration:W._options.idleSpeed,complete:function(){if(Z==Y-1){P.active=false}}})})},showAll:function(){W.clearTimer("idle");w.each(P.trunk,function(Y,Z){P.show(Z)})},show:function(Y){var Z=Y.data("idle");if(!P.active||(!Z.busy&&!Z.complete)){Z.busy=true;W.trigger(N.IDLE_EXIT);W.clearTimer("idle");B.animate(Y,Z.from,{duration:W._options.idleSpeed/2,complete:function(){P.active=true;w(Y).data("idle").busy=false;w(Y).data("idle").complete=true}})}P.addTimer()}};var M=this._lightbox={width:0,height:0,initialized:false,active:null,image:null,elems:{},keymap:false,init:function(){if(M.initialized){return}M.initialized=true;var Y="overlay box content shadow title info close prevholder prev nextholder next counter image",Z={},ab=W._options,ae="",ah="position:absolute;",ad="lightbox-",ac={overlay:"position:fixed;display:none;opacity:"+ab.overlayOpacity+";filter:alpha(opacity="+(ab.overlayOpacity*100)+");top:0;left:0;width:100%;height:100%;background:"+ab.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:ah+"background:#000;width:100%;height:100%;",content:ah+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:ah+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:ah+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:ah+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:ah+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:ah+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:ah+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:ah+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},af=function(ai){return ai.hover(function(){w(this).css("color","#bbb")},function(){w(this).css("color","#444")})},ag={};var aa="";if(o>7){aa=o<9?"background:#000;filter:alpha(opacity=0);":"background:rgba(0,0,0,0);"}else{aa="z-index:99999"}ac.nextholder+=aa;ac.prevholder+=aa;w.each(ac,function(ai,aj){ae+=".galleria-"+ad+ai+"{"+aj+"}"});ae+=".galleria-"+ad+"box.iframe .galleria-"+ad+"prevholder,.galleria-"+ad+"box.iframe .galleria-"+ad+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}";B.insertStyleTag(ae,"galleria-lightbox");w.each(Y.split(" "),function(ai,aj){W.addElement("lightbox-"+aj);Z[aj]=M.elems[aj]=W.get("lightbox-"+aj)});M.image=new N.Picture();w.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(aj,ak){var ai=[];w.each(ak.split(" "),function(al,am){ai.push(ad+am)});ag[ad+aj]=ai});W.append(ag);w(Z.image).append(M.image.container);w(r().body).append(Z.overlay,Z.box);af(w(Z.close).on("click:fast",M.hide).html("&#215;"));w.each(["Prev","Next"],function(al,aj){var ak=w(Z[aj.toLowerCase()]).html(/v/.test(aj)?"&#8249;&#160;":"&#160;&#8250;"),ai=w(Z[aj.toLowerCase()+"holder"]);ai.on("click:fast",function(){M["show"+aj]()});if(o<8||N.TOUCH){ak.show();return}ai.hover(function(){ak.show()},function(am){ak.stop().fadeOut(200)})});w(Z.overlay).on("click:fast",M.hide);if(N.IPAD){W._options.lightboxTransitionSpeed=0}},rescale:function(ac){var ab=f.min(u.width()-40,M.width),Y=f.min(u.height()-60,M.height),aa=f.min(ab/M.width,Y/M.height),Z=f.round(M.width*aa)+40,ae=f.round(M.height*aa)+60,ad={width:Z,height:ae,"margin-top":f.ceil(ae/2)*-1,"margin-left":f.ceil(Z/2)*-1};if(ac){w(M.elems.box).css(ad)}else{w(M.elems.box).animate(ad,{duration:W._options.lightboxTransitionSpeed,easing:W._options.easing,complete:function(){var ag=M.image,af=W._options.lightboxFadeSpeed;W.trigger({type:N.LIGHTBOX_IMAGE,imageTarget:ag.image});w(ag.container).show();w(ag.image).animate({opacity:1},af);B.show(M.elems.info,af)}})}},hide:function(){M.image.image=null;u.off("resize",M.rescale);w(M.elems.box).hide().find("iframe").remove();B.hide(M.elems.info);W.detachKeyboard();W.attachKeyboard(M.keymap);M.keymap=false;B.hide(M.elems.overlay,200,function(){w(this).hide().css("opacity",W._options.overlayOpacity);W.trigger(N.LIGHTBOX_CLOSE)})},showNext:function(){M.show(W.getNext(M.active))},showPrev:function(){M.show(W.getPrev(M.active))},show:function(Y){M.active=Y=typeof Y==="number"?Y:W.getIndex()||0;if(!M.initialized){M.init()}W.trigger(N.LIGHTBOX_OPEN);if(!M.keymap){M.keymap=w.extend({},W._keyboard.map);W.attachKeyboard({escape:M.hide,right:M.showNext,left:M.showPrev})}u.off("resize",M.rescale);var ac=W.getData(Y),aa=W.getDataLength(),af=W.getNext(Y),ab,ae,Z;B.hide(M.elems.info);try{for(Z=W._options.preload;Z>0;Z--){ae=new N.Picture();ab=W.getData(af);ae.preload(ab.big?ab.big:ab.image);af=W.getNext(af)}}catch(ad){}M.image.isIframe=(ac.iframe&&!ac.image);w(M.elems.box).toggleClass("iframe",M.image.isIframe);w(M.image.container).find(".galleria-videoicon").remove();M.image.load(ac.big||ac.image||ac.iframe,function(ak){if(ak.isIframe){var ah=w(D).width(),ai=w(D).height();if(ak.video&&W._options.maxVideoSize){var aj=f.min(W._options.maxVideoSize/ah,W._options.maxVideoSize/ai);if(aj<1){ah*=aj;ai*=aj}}M.width=ah;M.height=ai}else{M.width=ak.original.width;M.height=ak.original.height}w(ak.image).css({width:ak.isIframe?"100%":"100.1%",height:ak.isIframe?"100%":"100.1%",top:0,bottom:0,zIndex:99998,opacity:0,visibility:"visible"}).parent().height("100%");M.elems.title.innerHTML=ac.title||"";M.elems.counter.innerHTML=(Y+1)+" / "+aa;u.resize(M.rescale);M.rescale();if(ac.image&&ac.iframe){w(M.elems.box).addClass("iframe");if(ac.video){var ag=s(ak.container).hide();D.setTimeout(function(){ag.fadeIn(200)},200)}w(ak.image).css("cursor","pointer").mouseup((function(al,am){return function(an){w(M.image.container).find(".galleria-videoicon").remove();an.preventDefault();am.isIframe=true;am.load(al.iframe+(al.video?"&autoplay=1":""),{width:"100%",height:o<8?w(M.image.container).height():"100%"})}}(ac,ak)))}});w(M.elems.overlay).show().css("visibility","visible");w(M.elems.box).show()}};var F=this._timer={trunk:{},add:function(ac,ab,aa,Z){ac=ac||new Date().getTime();Z=Z||false;this.clear(ac);if(Z){var Y=ab;ab=function(){Y();F.add(ac,ab,aa)}}this.trunk[ac]=D.setTimeout(ab,aa)},clear:function(aa){var Y=function(ab){D.clearTimeout(this.trunk[ab]);delete this.trunk[ab]},Z;if(!!aa&&aa in this.trunk){Y.call(this,aa)}else{if(typeof aa==="undefined"){for(Z in this.trunk){if(this.trunk.hasOwnProperty(Z)){Y.call(this,Z)}}}}}};return this};N.prototype={constructor:N,init:function(P,F){F=t(F);this._original={target:P,options:F,data:null};this._target=this._dom.target=P.nodeName?P:w(P).get(0);this._original.html=this._target.innerHTML;g.push(this);if(!this._target){N.raise("Target not found",true);return}this._options={autoplay:false,carousel:true,carouselFollow:true,carouselSpeed:400,carouselSteps:"auto",clicknext:false,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(Q){return{}},dataSelector:"img",dataSort:false,dataSource:this._target,debug:q,dummy:q,easing:"galleria",extend:function(Q){},fullscreenCrop:q,fullscreenDoubleTap:true,fullscreenTransition:q,height:0,idleMode:true,idleTime:3000,idleSpeed:200,imageCrop:false,imageMargin:0,imagePan:false,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:q,initialTransition:q,keepSource:false,layerFollow:true,lightbox:false,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:true,maxScaleRatio:q,maxVideoSize:q,minScaleRatio:q,overlayOpacity:0.85,overlayBackground:"#0b0b0b",pauseOnInteraction:true,popupLinks:false,preload:2,queue:true,responsive:true,show:0,showInfo:true,showCounter:true,showImagenav:true,swipe:"auto",theme:null,thumbCrop:true,thumbEventType:"click:fast",thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:true,thumbPosition:"50%",thumbnails:true,touchTransition:q,transition:"fade",transitionInitial:q,transitionSpeed:400,trueFullscreen:true,useCanvas:false,variation:"",videoPoster:true,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5000,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}};this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial;if(F){if(F.debug===false){v=false}if(typeof F.imageTimeout==="number"){l=F.imageTimeout}if(typeof F.dummy==="string"){j=F.dummy}if(typeof F.theme=="string"){this._options.theme=F.theme}}w(this._target).children().hide();if(N.QUIRK){N.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype.")}if(A.length){if(this._options.theme){for(var M=0;M<A.length;M++){if(this._options.theme===A[M].name){this.theme=A[M];break}}}else{this.theme=A[0]}}if(typeof this.theme=="object"){this._init()}else{C.push(this)}return this},_init:function(){var M=this,P=this._options;if(this._initialized){N.raise("Init failed: Gallery instance already initialized.");return this}this._initialized=true;if(!this.theme){N.raise("Init failed: No theme found.",true);return this}w.extend(true,P,this.theme.defaults,this._original.options,N.configure.options);P.swipe=(function(R){if(R=="enforced"){return true}if(R===false||R=="disabled"){return false}return !!N.TOUCH}(P.swipe));if(P.swipe){P.clicknext=false;P.imagePan=false}(function(R){if(!("getContext" in R)){R=null;return}n=n||{elem:R,context:R.getContext("2d"),cache:{},length:0}}(c.createElement("canvas")));this.bind(N.DATA,function(){if(D.screen&&D.screen.width&&Array.prototype.forEach){this._data.forEach(function(W){var V="devicePixelRatio" in D?D.devicePixelRatio:1,U=f.max(D.screen.width,D.screen.height);if(U*V<1024){W.big=W.image}})}this._original.data=this._data;this.get("total").innerHTML=this.getDataLength();var T=this.$("container");if(M._options.height<2){M._userRatio=M._ratio=M._options.height}var S={width:0,height:0};var R=function(){return M.$("stage").height()};B.wait({until:function(){S=M._getWH();T.width(S.width).height(S.height);return R()&&S.width&&S.height>50},success:function(){M._width=S.width;M._height=S.height;M._ratio=M._ratio||S.height/S.width;if(N.WEBKIT){D.setTimeout(function(){M._run()},1)}else{M._run()}},error:function(){if(R()){N.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+S.width+"px, height: "+S.height+"px.",true)}else{N.raise("Could not extract a stage height from the CSS. Traced height: "+R()+"px.",true)}},timeout:typeof this._options.wait=="number"?this._options.wait:false})});this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]});B.hide(this.$("counter").append(this.get("current"),c.createTextNode(" / "),this.get("total")));this.setCounter("&#8211;");B.hide(M.get("tooltip"));this.$("container").addClass([(N.TOUCH?"touch":"notouch"),this._options.variation,"galleria-theme-"+this.theme.name].join(" "));if(!this._options.swipe){w.each(new Array(2),function(R){var S=new N.Picture();w(S.container).css({position:"absolute",top:0,left:0}).prepend(M._layers[R]=w(B.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]);M.$("images").append(S.container);M._controls[R]=S;var T=new N.Picture();T.isIframe=true;w(T.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(S.container);M._controls.frames[R]=T})}this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"});if(P.swipe){this.$("images").css({position:"absolute",top:0,left:0,width:0,height:"100%"});this.finger=new N.Finger(this.get("stage"),{onchange:function(R){M.pause().show(R)},oncomplete:function(T){var R=f.max(0,f.min(parseInt(T,10),M.getDataLength()-1)),S=M.getData(R);w(M._thumbnails[R].container).addClass("active").siblings(".active").removeClass("active");if(!S){return}M.$("images").find(".galleria-frame").css("opacity",0).hide().find("iframe").remove();if(M._options.carousel&&M._options.carouselFollow){M._carousel.follow(R)}}});this.bind(N.RESCALE,function(){this.finger.setup()});this.$("stage").on("click",function(V){var T=M.getData();if(!T){return}if(T.iframe){if(M.isPlaying()){M.pause()}var W=M._controls.frames[M._active],R=M._stageWidth,S=M._stageHeight;if(w(W.container).find("iframe").length){return}w(W.container).css({width:R,height:S,opacity:0}).show().animate({opacity:1},200);D.setTimeout(function(){W.load(T.iframe+(T.video?"&autoplay=1":""),{width:R,height:S},function(X){M.$("container").addClass("videoplay");X.scale({width:M._stageWidth,height:M._stageHeight,iframelimit:T.video?M._options.maxVideoSize:q})})},100);return}if(T.link){if(M._options.popupLinks){var U=D.open(T.link,"_blank")}else{D.location.href=T.link}return}});this.bind(N.IMAGE,function(V){M.setCounter(V.index);M.setInfo(V.index);var T=this.getNext(),U=this.getPrev();var S=[U,T];S.push(this.getNext(T),this.getPrev(U),M._controls.slides.length-1);var R=[];w.each(S,function(W,X){if(w.inArray(X,R)==-1){R.push(X)}});w.each(R,function(X,Y){var aa=M.getData(Y),W=M._controls.slides[Y],Z=M.isFullscreen()&&aa.big?aa.big:(aa.image||aa.iframe);if(aa.iframe&&!aa.image){W.isIframe=true}if(!W.ready){M._controls.slides[Y].load(Z,function(ab){if(!ab.isIframe){w(ab.image).css("visibility","hidden")}M._scaleImage(ab,{complete:function(ac){if(!ac.isIframe){w(ac.image).css({opacity:0,visibility:"visible"}).animate({opacity:1},200)}}})})}})})}this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"});this.$("image-nav-right, image-nav-left").on("click:fast",function(S){if(P.pauseOnInteraction){M.pause()}var R=/right/.test(this.className)?"next":"prev";M[R]()}).on("click",function(R){R.preventDefault();if(P.clicknext||P.swipe){R.stopPropagation()}});w.each(["info","counter","image-nav"],function(R,S){if(P["show"+S.substr(0,1).toUpperCase()+S.substr(1).replace(/-/,"")]===false){B.moveOut(M.get(S.toLowerCase()))}});this.load();if(!P.keepSource&&!o){this._target.innerHTML=""}if(this.get("errors")){this.appendChild("target","errors")}this.appendChild("target","container");if(P.carousel){var Q=0,F=P.show;this.bind(N.THUMBNAIL,function(){this.updateCarousel();if(++Q==this.getDataLength()&&typeof F=="number"&&F>0){this._carousel.follow(F)}})}if(P.responsive){u.on("resize",function(){if(!M.isFullscreen()){M.resize()}})}if(P.fullscreenDoubleTap){this.$("stage").on("touchstart",(function(){var V,S,X,W,U,T,R=function(Y){return Y.originalEvent.touches?Y.originalEvent.touches[0]:Y};M.$("stage").on("touchmove",function(){V=0});return function(Y){if(/(-left|-right)/.test(Y.target.className)){return}T=B.timestamp();S=R(Y).pageX;X=R(Y).pageY;if(Y.originalEvent.touches.length<2&&(T-V<300)&&(S-W<20)&&(X-U<20)){M.toggleFullscreen();Y.preventDefault();return}V=T;W=S;U=X}}()))}w.each(N.on.binds,function(R,S){if(w.inArray(S.hash,M._binds)==-1){M.bind(S.type,S.callback)}});return this},addTimer:function(){this._timer.add.apply(this._timer,B.array(arguments));return this},clearTimer:function(){this._timer.clear.apply(this._timer,B.array(arguments));return this},_getWH:function(){var R=this.$("container"),M=this.$("target"),P=this,Q={},F;w.each(["width","height"],function(T,S){if(P._options[S]&&typeof P._options[S]==="number"){Q[S]=P._options[S]}else{F=[B.parseValue(R.css(S)),B.parseValue(M.css(S)),R[S](),M[S]()];if(!P["_"+S]){F.splice(F.length,B.parseValue(R.css("min-"+S)),B.parseValue(M.css("min-"+S)))}Q[S]=f.max.apply(f,F)}});if(P._userRatio){Q.height=Q.width*P._userRatio}return Q},_createThumbnails:function(S){this.get("total").innerHTML=this.getDataLength();var R,ad,ae,aa,X=this,Y=this._options,ab=S?this._data.length-S.length:0,U=ab,ac=[],Z=0,W=o<8?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",Q=(function(){var ag=X.$("thumbnails").find(".active");if(!ag.length){return false}return ag.find("img").attr("src")}()),af=typeof Y.thumbnails==="string"?Y.thumbnails.toLowerCase():null,P=function(ag){return c.defaultView&&c.defaultView.getComputedStyle?c.defaultView.getComputedStyle(ad.container,null)[ag]:aa.css(ag)},F=function(ai,ah,ag){return function(){w(ag).append(ai);X.trigger({type:N.THUMBNAIL,thumbTarget:ai,index:ah,galleriaData:X.getData(ah)})}},T=function(ah){if(Y.pauseOnInteraction){X.pause()}var ag=w(ah.currentTarget).data("index");if(X.getIndex()!==ag){X.show(ag)}ah.preventDefault()},M=function(ag,ah){w(ag.container).css("visibility","visible");X.trigger({type:N.THUMBNAIL,thumbTarget:ag.image,index:ag.data.order,galleriaData:X.getData(ag.data.order)});if(typeof ah=="function"){ah.call(X,ag)}},V=function(ag,ah){ag.scale({width:ag.data.width,height:ag.data.height,crop:Y.thumbCrop,margin:Y.thumbMargin,canvas:Y.useCanvas,position:Y.thumbPosition,complete:function(ak){var an=["left","top"],aj=["Width","Height"],ai,al,am=X.getData(ak.index);w.each(aj,function(ao,ap){ai=ap.toLowerCase();if((Y.thumbCrop!==true||Y.thumbCrop===ai)){al={};al[ai]=ak[ai];w(ak.container).css(al);al={};al[an[ao]]=0;w(ak.image).css(al)}ak["outer"+ap]=w(ak.container)["outer"+ap](true)});B.toggleQuality(ak.image,Y.thumbQuality===true||(Y.thumbQuality==="auto"&&ak.original.width<ak.width*3));if(Y.thumbDisplayOrder&&!ak.lazy){w.each(ac,function(ao,ap){if(ao===Z&&ap.ready&&!ap.displayed){Z++;ap.displayed=true;M(ap,ah);return}})}else{M(ak,ah)}}})};if(!S){this._thumbnails=[];this.$("thumbnails").empty()}for(;this._data[ab];ab++){ae=this._data[ab];R=ae.thumb||ae.image;if((Y.thumbnails===true||af=="lazy")&&(ae.thumb||ae.image)){ad=new N.Picture(ab);ad.index=ab;ad.displayed=false;ad.lazy=false;ad.video=false;this.$("thumbnails").append(ad.container);aa=w(ad.container);aa.css("visibility","hidden");ad.data={width:B.parseValue(P("width")),height:B.parseValue(P("height")),order:ab,src:R};if(Y.thumbCrop!==true){aa.css({width:"auto",height:"auto"})}else{aa.css({width:ad.data.width,height:ad.data.height})}if(af=="lazy"){aa.addClass("lazy");ad.lazy=true;ad.load(W,{height:ad.data.height,width:ad.data.width})}else{ad.load(R,V)}if(Y.preload==="all"){ad.preload(ae.image)}}else{if((ae.iframe&&af!==null)||af==="empty"||af==="numbers"){ad={container:B.create("galleria-image"),image:B.create("img","span"),ready:true,data:{order:ab}};if(af==="numbers"){w(ad.image).text(ab+1)}if(ae.iframe){w(ad.image).addClass("iframe")}this.$("thumbnails").append(ad.container);D.setTimeout((F)(ad.image,ab,ad.container),50+(ab*20))}else{ad={container:null,image:null}}}w(ad.container).add(Y.keepSource&&Y.linkSourceImages?ae.original:null).data("index",ab).on(Y.thumbEventType,T).data("thumbload",V);if(Q===R){w(ad.container).addClass("active")}this._thumbnails.push(ad)}ac=this._thumbnails.slice(U);return this},lazyLoad:function(R,M){var F=R.constructor==Array?R:[R],P=this,Q=0;w.each(F,function(T,W){if(W>P._thumbnails.length-1){return}var S=P._thumbnails[W],V=S.data,X=function(){if(++Q==F.length&&typeof M=="function"){M.call(P)}},U=w(S.container).data("thumbload");if(S.video){U.call(P,S,X)}else{S.load(V.src,function(Y){U.call(P,Y,X)})}});return this},lazyLoadChunks:function(V,P){var R=this.getDataLength(),M=0,F=0,Q=[],S=[],U=this;P=P||0;for(;M<R;M++){S.push(M);if(++F==V||M==R-1){Q.push(S);F=0;S=[]}}var T=function(X){var W=Q.shift();if(W){D.setTimeout(function(){U.lazyLoad(W,function(){T(true)})},(P&&X)?P:0)}};T(false);return this},_run:function(){var F=this;F._createThumbnails();B.wait({timeout:10000,until:function(){if(N.OPERA){F.$("stage").css("display","inline-block")}F._stageWidth=F.$("stage").width();F._stageHeight=F.$("stage").height();return(F._stageWidth&&F._stageHeight>50)},success:function(){a.push(F);if(F._options.swipe){var M=F.$("images").width(F.getDataLength()*F._stageWidth);w.each(new Array(F.getDataLength()),function(P){var R=new N.Picture(),Q=F.getData(P);w(R.container).css({position:"absolute",top:0,left:F._stageWidth*P}).prepend(F._layers[P]=w(B.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]).appendTo(M);if(Q.video){s(R.container)}F._controls.slides.push(R);var S=new N.Picture();S.isIframe=true;w(S.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(R.container);F._controls.frames.push(S)});F.finger.setup()}B.show(F.get("counter"));if(F._options.carousel){F._carousel.bindControls()}if(F._options.autoplay){F.pause();if(typeof F._options.autoplay==="number"){F._playtime=F._options.autoplay}F._playing=true}if(F._firstrun){if(F._options.autoplay){F.trigger(N.PLAY)}if(typeof F._options.show==="number"){F.show(F._options.show)}return}F._firstrun=true;if(N.History){N.History.change(function(P){if(isNaN(P)){D.history.go(-1)}else{F.show(P,q,true)}})}F.trigger(N.READY);F.theme.init.call(F,F._options);w.each(N.ready.callbacks,function(P,Q){if(typeof Q=="function"){Q.call(F,F._options)}});F._options.extend.call(F,F._options);if(/^[0-9]{1,4}$/.test(e)&&N.History){F.show(e,q,true)}else{if(F._data[F._options.show]){F.show(F._options.show)}}if(F._options.autoplay){F.trigger(N.PLAY)}},error:function(){N.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+F._stageWidth+"px, height: "+F._stageHeight+"px.",true)}})},load:function(Q,F,P){var M=this,R=this._options;this._data=[];this._thumbnails=[];this.$("thumbnails").empty();if(typeof F==="function"){P=F;F=null}Q=Q||R.dataSource;F=F||R.dataSelector;P=P||R.dataConfig;if(w.isPlainObject(Q)){Q=[Q]}if(w.isArray(Q)){if(this.validate(Q)){this._data=Q}else{N.raise("Load failed: JSON Array not valid.")}}else{F+=",.video,.iframe";w(Q).find(F).each(function(U,W){W=w(W);var X={},V=W.parent(),T=V.attr("href"),S=V.attr("rel");if(T&&(W[0].nodeName=="IMG"||W.hasClass("video"))&&h(T)){X.video=T}else{if(T&&W.hasClass("iframe")){X.iframe=T}else{X.image=X.big=T}}if(S){X.big=S}w.each("big title description link layer image".split(" "),function(Y,Z){if(W.data(Z)){X[Z]=W.data(Z).toString()}});if(!X.big){X.big=X.image}M._data.push(w.extend({title:W.attr("title")||"",thumb:W.attr("src"),image:W.attr("src"),big:W.attr("src"),description:W.attr("alt")||"",link:W.attr("longdesc"),original:W.get(0)},X,P(W)))})}if(typeof R.dataSort=="function"){O.sort.call(this._data,R.dataSort)}else{if(R.dataSort=="random"){this._data.sort(function(){return f.round(f.random())-0.5})}}if(this.getDataLength()){this._parseData(function(){this.trigger(N.DATA)})}return this},_parseData:function(R){var F=this,Q,M=false,P=function(){var S=true;w.each(F._data,function(T,U){if(U.loading){S=false;return false}});if(S&&!M){M=true;R.call(F)}};w.each(this._data,function(T,U){Q=F._data[T];if("thumb" in U===false){Q.thumb=U.image}if(!U.big){Q.big=U.image}if("video" in U){var S=h(U.video);if(S){Q.iframe=new J(S.provider,S.id).embed()+(function(){if(typeof F._options[S.provider]=="object"){var W="?",V=[];w.each(F._options[S.provider],function(X,Y){V.push(X+"="+Y)});if(S.provider=="youtube"){V=["wmode=opaque"].concat(V)}return W+V.join("&")}return""}());if(!Q.thumb||!Q.image){w.each(["thumb","image"],function(V,W){if(W=="image"&&!F._options.videoPoster){Q.image=q;return}var X=new J(S.provider,S.id);if(!Q[W]){Q.loading=true;X.getMedia(W,(function(Z,Y){return function(aa){Z[Y]=aa;if(Y=="image"&&!Z.big){Z.big=Z.image}delete Z.loading;P()}}(Q,W)))}})}}}});P();return this},destroy:function(){this.$("target").data("galleria",null);this.$("container").off("galleria");this.get("target").innerHTML=this._original.html;this.clearTimer();B.removeFromArray(g,this);B.removeFromArray(a,this);if(N._waiters.length){w.each(N._waiters,function(M,F){if(F){D.clearTimeout(F)}})}return this},splice:function(){var F=this,M=B.array(arguments);D.setTimeout(function(){O.splice.apply(F._data,M);F._parseData(function(){F._createThumbnails()})},2);return F},push:function(){var F=this,M=B.array(arguments);if(M.length==1&&M[0].constructor==Array){M=M[0]}D.setTimeout(function(){O.push.apply(F._data,M);F._parseData(function(){F._createThumbnails(M)})},2);return F},_getActive:function(){return this._controls.getActive()},validate:function(F){return true},bind:function(M,F){M=H(M);this.$("container").on(M,this.proxy(F));return this},unbind:function(F){F=H(F);this.$("container").off(F);return this},trigger:function(F){F=typeof F==="object"?w.extend(F,{scope:this}):{type:H(F),scope:this};this.$("container").trigger(F);return this},addIdleState:function(P,M,Q,F){this._idle.add.apply(this._idle,B.array(arguments));return this},removeIdleState:function(F){this._idle.remove.apply(this._idle,B.array(arguments));return this},enterIdleMode:function(){this._idle.hide();return this},exitIdleMode:function(){this._idle.showAll();return this},enterFullscreen:function(F){this._fullscreen.enter.apply(this,B.array(arguments));return this},exitFullscreen:function(F){this._fullscreen.exit.apply(this,B.array(arguments));return this},toggleFullscreen:function(F){this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,B.array(arguments));return this},bindTooltip:function(F,M){this._tooltip.bind.apply(this._tooltip,B.array(arguments));return this},defineTooltip:function(F,M){this._tooltip.define.apply(this._tooltip,B.array(arguments));return this},refreshTooltip:function(F){this._tooltip.show.apply(this._tooltip,B.array(arguments));return this},openLightbox:function(){this._lightbox.show.apply(this._lightbox,B.array(arguments));return this},closeLightbox:function(){this._lightbox.hide.apply(this._lightbox,B.array(arguments));return this},hasVariation:function(F){return w.inArray(F,this._options.variation.split(/\s+/))>-1},getActiveImage:function(){var F=this._getActive();return F?F.image:q},getActiveThumb:function(){return this._thumbnails[this._active].image||q},getMousePosition:function(F){return{x:F.pageX-this.$("container").offset().left,y:F.pageY-this.$("container").offset().top}},addPan:function(T){if(this._options.imageCrop===false){return}T=w(T||this.getActiveImage());var ad=this,ac=T.width()/2,Z=T.height()/2,ab=parseInt(T.css("left"),10),aa=parseInt(T.css("top"),10),P=ab||0,M=aa||0,Y=0,X=0,R=false,W=B.timestamp(),F=0,Q=0,V=function(ag,af,ah){if(ag>0){Q=f.round(f.max(ag*-1,f.min(0,af)));if(F!==Q){F=Q;if(o===8){T.parent()["scroll"+ah](Q*-1)}else{var ae={};ae[ah.toLowerCase()]=Q;T.css(ae)}}}},S=function(ae){if(B.timestamp()-W<50){return}R=true;ac=ad.getMousePosition(ae).x;Z=ad.getMousePosition(ae).y},U=function(ae){if(!R){return}Y=T.width()-ad._stageWidth;X=T.height()-ad._stageHeight;ab=ac/ad._stageWidth*Y*-1;aa=Z/ad._stageHeight*X*-1;P+=(ab-P)/ad._options.imagePanSmoothness;M+=(aa-M)/ad._options.imagePanSmoothness;V(X,M,"Top");V(Y,P,"Left")};if(o===8){T.parent().scrollTop(M*-1).scrollLeft(P*-1);T.css({top:0,left:0})}this.$("stage").off("mousemove",S).on("mousemove",S);this.addTimer("pan"+ad._id,U,50,true);return this},proxy:function(M,F){if(typeof M!=="function"){return i}F=F||this;return function(){return M.apply(F,B.array(arguments))}},getThemeName:function(){return this.theme.name},removePan:function(){this.$("stage").off("mousemove");this.clearTimer("pan"+this._id);return this},addElement:function(M){var F=this._dom;w.each(B.array(arguments),function(Q,P){F[P]=B.create("galleria-"+P)});return this},attachKeyboard:function(F){this._keyboard.attach.apply(this._keyboard,B.array(arguments));return this},detachKeyboard:function(){this._keyboard.detach.apply(this._keyboard,B.array(arguments));return this},appendChild:function(M,F){this.$(M).append(this.get(F)||F);return this},prependChild:function(M,F){this.$(M).prepend(this.get(F)||F);return this},remove:function(F){this.$(B.array(arguments).join(",")).remove();return this},append:function(P){var M,F;for(M in P){if(P.hasOwnProperty(M)){if(P[M].constructor===Array){for(F=0;P[M][F];F++){this.appendChild(M,P[M][F])}}else{this.appendChild(M,P[M])}}}return this},_scaleImage:function(Q,M){Q=Q||this._controls.getActive();if(!Q){return}var F,P=function(R){w(R.container).children(":first").css({top:f.max(0,B.parseValue(R.image.style.top)),left:f.max(0,B.parseValue(R.image.style.left)),width:B.parseValue(R.image.width),height:B.parseValue(R.image.height)})};M=w.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},M);if(this._options.layerFollow&&this._options.imageCrop!==true){if(typeof M.complete=="function"){F=M.complete;M.complete=function(){F.call(Q,Q);P(Q)}}else{M.complete=P}}else{w(Q.container).children(":first").css({top:0,left:0})}Q.scale(M);return this},updateCarousel:function(){this._carousel.update();return this},resize:function(P,F){if(typeof P=="function"){F=P;P=q}P=w.extend({width:0,height:0},P);var M=this,Q=this.$("container");w.each(P,function(R,S){if(!S){Q[R]("auto");P[R]=M._getWH()[R]}});w.each(P,function(R,S){Q[R](S)});return this.rescale(F)},rescale:function(Q,F,M){var P=this;if(typeof Q==="function"){M=Q;Q=q}var R=function(){P._stageWidth=Q||P.$("stage").width();P._stageHeight=F||P.$("stage").height();if(P._options.swipe){w.each(P._controls.slides,function(U,T){P._scaleImage(T);w(T.container).css("left",P._stageWidth*U)});P.$("images").css("width",P._stageWidth*P.getDataLength())}else{P._scaleImage()}if(P._options.carousel){P.updateCarousel()}var S=P._controls.frames[P._controls.active];if(S){P._controls.frames[P._controls.active].scale({width:P._stageWidth,height:P._stageHeight,iframelimit:P._options.maxVideoSize})}P.trigger(N.RESCALE);if(typeof M==="function"){M.call(P)}};R.call(P);return this},refreshImage:function(){this._scaleImage();if(this._options.imagePan){this.addPan()}return this},_preload:function(){if(this._options.preload){var Q,F,R=this.getNext(),M;try{for(F=this._options.preload;F>0;F--){Q=new N.Picture();M=this.getData(R);Q.preload(this.isFullscreen()&&M.big?M.big:M.image);R=this.getNext(R)}}catch(P){}}},show:function(W,S,V){var U=this._options.swipe;if(!U&&(this._queue.length>3||W===false||(!this._options.queue&&this._queue.stalled))){return}W=f.max(0,f.min(parseInt(W,10),this.getDataLength()-1));S=typeof S!=="undefined"?!!S:W<this.getIndex();V=V||false;if(!V&&N.History){N.History.set(W.toString());return}if(this.finger&&W!==this._active){this.finger.to=-(W*this.finger.width);this.finger.index=W}this._active=W;if(U){var T=this.getData(W),Y=this;if(!T){return}var M=this.isFullscreen()&&T.big?T.big:(T.image||T.iframe),R=this._controls.slides[W],Q=R.isCached(M),F=this._thumbnails[W];var X={cached:Q,index:W,rewind:S,imageTarget:R.image,thumbTarget:F.image,galleriaData:T};this.trigger(w.extend(X,{type:N.LOADSTART}));Y.$("container").removeClass("videoplay");var P=function(){Y._layers[W].innerHTML=Y.getData().layer||"";Y.trigger(w.extend(X,{type:N.LOADFINISH}));Y._playCheck()};Y._preload();D.setTimeout(function(){if(!R.ready||w(R.image).attr("src")!=M){if(T.iframe&&!T.image){R.isIframe=true}R.load(M,function(Z){X.imageTarget=Z.image;Y._scaleImage(Z,P).trigger(w.extend(X,{type:N.IMAGE}));P()})}else{Y.trigger(w.extend(X,{type:N.IMAGE}));P()}},100)}else{O.push.call(this._queue,{index:W,rewind:S});if(!this._queue.stalled){this._show()}}return this},_show:function(){var W=this,V=this._queue[0],T=this.getData(V.index);if(!T){return}var F=this.isFullscreen()&&T.big?T.big:(T.image||T.iframe),S=this._controls.getActive(),U=this._controls.getNext(),Q=U.isCached(F),M=this._thumbnails[V.index],R=function(){w(U.image).trigger("mouseup")};W.$("container").toggleClass("iframe",!!T.isIframe).removeClass("videoplay");var P=(function(aa,Z,ab,X,Y){return function(){var ac;k.active=false;B.toggleQuality(Z.image,W._options.imageQuality);W._layers[W._controls.active].innerHTML="";w(ab.container).css({zIndex:0,opacity:0}).show();w(ab.container).find("iframe, .galleria-videoicon").remove();w(W._controls.frames[W._controls.active].container).hide();w(Z.container).css({zIndex:1,left:0,top:0}).show();W._controls.swap();if(W._options.imagePan){W.addPan(Z.image)}if((aa.iframe&&aa.image)||aa.link||W._options.lightbox||W._options.clicknext){w(Z.image).css({cursor:"pointer"}).on("mouseup",function(af){if(typeof af.which=="number"&&af.which>1){return}if(aa.iframe){if(W.isPlaying()){W.pause()}var ag=W._controls.frames[W._controls.active],ad=W._stageWidth,ae=W._stageHeight;w(ag.container).css({width:ad,height:ae,opacity:0}).show().animate({opacity:1},200);D.setTimeout(function(){ag.load(aa.iframe+(aa.video?"&autoplay=1":""),{width:ad,height:ae},function(ah){W.$("container").addClass("videoplay");ah.scale({width:W._stageWidth,height:W._stageHeight,iframelimit:aa.video?W._options.maxVideoSize:q})})},100);return}if(W._options.clicknext&&!N.TOUCH){if(W._options.pauseOnInteraction){W.pause()}W.next();return}if(aa.link){if(W._options.popupLinks){ac=D.open(aa.link,"_blank")}else{D.location.href=aa.link}return}if(W._options.lightbox){W.openLightbox()}})}W._playCheck();W.trigger({type:N.IMAGE,index:X.index,imageTarget:Z.image,thumbTarget:Y.image,galleriaData:aa});O.shift.call(W._queue);W._queue.stalled=false;if(W._queue.length){W._show()}}}(T,U,S,V,M));if(this._options.carousel&&this._options.carouselFollow){this._carousel.follow(V.index)}W._preload();B.show(U.container);U.isIframe=T.iframe&&!T.image;w(W._thumbnails[V.index].container).addClass("active").siblings(".active").removeClass("active");W.trigger({type:N.LOADSTART,cached:Q,index:V.index,rewind:V.rewind,imageTarget:U.image,thumbTarget:M.image,galleriaData:T});W._queue.stalled=true;U.load(F,function(Y){var X=w(W._layers[1-W._controls.active]).html(T.layer||"").hide();W._scaleImage(Y,{complete:function(Z){if("image" in S){B.toggleQuality(S.image,false)}B.toggleQuality(Z.image,false);W.removePan();W.setInfo(V.index);W.setCounter(V.index);if(T.layer){X.show();if((T.iframe&&T.image)||T.link||W._options.lightbox||W._options.clicknext){X.css("cursor","pointer").off("mouseup").mouseup(R)}}if(T.video&&T.image){s(Z.container)}var ab=W._options.transition;w.each({initial:S.image===null,touch:N.TOUCH,fullscreen:W.isFullscreen()},function(ad,ac){if(ac&&W._options[ad+"Transition"]!==q){ab=W._options[ad+"Transition"];return false}});if(ab in k.effects===false){P()}else{var aa={prev:S.container,next:Z.container,rewind:V.rewind,speed:W._options.transitionSpeed||400};k.active=true;k.init.call(W,ab,aa,P)}W.trigger({type:N.LOADFINISH,cached:Q,index:V.index,rewind:V.rewind,imageTarget:Z.image,thumbTarget:W._thumbnails[V.index].image,galleriaData:W.getData(V.index)})}})})},getNext:function(F){F=typeof F==="number"?F:this.getIndex();return F===this.getDataLength()-1?0:F+1},getPrev:function(F){F=typeof F==="number"?F:this.getIndex();return F===0?this.getDataLength()-1:F-1},next:function(){if(this.getDataLength()>1){this.show(this.getNext(),false)}return this},prev:function(){if(this.getDataLength()>1){this.show(this.getPrev(),true)}return this},get:function(F){return F in this._dom?this._dom[F]:null},getData:function(F){return F in this._data?this._data[F]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return typeof this._active==="number"?this._active:false},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(F){return typeof F==="undefined"?this._options:this._options[F]},setOptions:function(F,M){if(typeof F==="object"){w.extend(this._options,F)}else{this._options[F]=M}return this},play:function(F){this._playing=true;this._playtime=F||this._playtime;this._playCheck();this.trigger(N.PLAY);return this},pause:function(){this._playing=false;this.trigger(N.PAUSE);return this},playToggle:function(F){return(this._playing)?this.pause():this.play(F)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var M=this,R=0,F=20,P=B.timestamp(),S="play"+this._id;if(this._playing){this.clearTimer(S);var Q=function(){R=B.timestamp()-P;if(R>=M._playtime&&M._playing){M.clearTimer(S);M.next();return}if(M._playing){M.trigger({type:N.PROGRESS,percent:f.ceil(R/M._playtime*100),seconds:f.floor(R/1000),milliseconds:R});M.addTimer(S,Q,F)}};M.addTimer(S,Q,F)}},setPlaytime:function(F){this._playtime=F;return this},setIndex:function(F){this._active=F;return this},setCounter:function(M){if(typeof M==="number"){M++}else{if(typeof M==="undefined"){M=this.getIndex()+1}}this.get("current").innerHTML=M;if(o){var P=this.$("counter"),F=P.css("opacity");if(parseInt(F,10)===1){B.removeAlpha(P[0])}else{this.$("counter").css("opacity",F)}}return this},setInfo:function(M){var F=this,P=this.getData(M);w.each(["title","description"],function(Q,R){var S=F.$("info-"+R);if(!!P[R]){S[P[R].length?"show":"hide"]().html(P[R])}else{S.empty().hide()}});return this},hasInfo:function(M){var F="title description".split(" "),P;for(P=0;F[P];P++){if(!!this.getData(M)[F[P]]){return true}}return false},jQuery:function(Q){var F=this,M=[];w.each(Q.split(","),function(R,S){S=w.trim(S);if(F.get(S)){M.push(S)}});var P=w(F.get(M.shift()));w.each(M,function(R,S){P=P.add(F.get(S))});return P},$:function(F){return this.jQuery.apply(this,B.array(arguments))}};w.each(z,function(F,P){var M=/_/.test(P)?P.replace(/_/g,""):P;N[P.toUpperCase()]="galleria."+M});w.extend(N,{IE9:o===9,IE8:o===8,IE7:o===7,IE6:o===6,IE:o,WEBKIT:/webkit/.test(I),CHROME:/chrome/.test(I),SAFARI:/safari/.test(I)&&!(/chrome/.test(I)),QUIRK:(o&&c.compatMode&&c.compatMode==="BackCompat"),MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!D.opera,IPHONE:/iphone/.test(I),IPAD:/ipad/.test(I),ANDROID:/android/.test(I),TOUCH:("ontouchstart" in c)});N.addTheme=function(P){if(!P.name){N.raise("No theme name specified")}if(typeof P.defaults!=="object"){P.defaults={}}else{P.defaults=t(P.defaults)}var F=false,M;if(typeof P.css==="string"){w("link").each(function(Q,R){M=new RegExp(P.css);if(M.test(R.href)){F=true;E(P);return false}});if(!F){w(function(){var R=0;var Q=function(){w("script").each(function(T,S){M=new RegExp("galleria\\."+P.name.toLowerCase()+"\\.");if(M.test(S.src)){F=S.src.replace(/[^\/]*$/,"")+P.css;D.setTimeout(function(){B.loadCSS(F,"galleria-theme-"+P.name,function(){E(P)})},1)}});if(!F){if(R++>5){N.raise("No theme CSS loaded")}else{D.setTimeout(Q,500)}}};Q()})}}else{E(P)}return P};N.loadTheme=function(Q,M){if(w("script").filter(function(){return w(this).attr("src")==Q}).length){return}var F=false,P;w(D).load(function(){if(!F){P=D.setTimeout(function(){if(!F){N.raise("Galleria had problems loading theme at "+Q+". Please check theme path or load manually.",true)}},20000)}});B.loadScript(Q,function(){F=true;D.clearTimeout(P)});return N};N.get=function(F){if(!!g[F]){return g[F]}else{if(typeof F!=="number"){return g}else{N.raise("Gallery index "+F+" not found")}}};N.configure=function(F,P){var M={};if(typeof F=="string"&&P){M[F]=P;F=M}else{w.extend(M,F)}N.configure.options=M;w.each(N.get(),function(R,Q){Q.setOptions(M)});return N};N.configure.options={};N.on=function(F,P){if(!F){return}P=P||i;var M=F+P.toString().replace(/\s/g,"")+B.timestamp();w.each(N.get(),function(R,Q){Q._binds.push(M);Q.bind(F,P)});N.on.binds.push({type:F,callback:P,hash:M});return N};N.on.binds=[];N.run=function(F,M){if(w.isFunction(M)){M={extend:M}}w(F||"#galleria").galleria(M);return N};N.addTransition=function(F,M){k.effects[F]=M;return N};N.utils=B;N.log=function(){var F=B.array(arguments);if("console" in D&&"log" in D.console){try{return D.console.log.apply(D.console,F)}catch(M){w.each(F,function(){D.console.log(this)})}}else{return D.alert(F.join("<br>"))}};N.ready=function(F){if(typeof F!="function"){return N}w.each(a,function(P,M){F.call(M,M._options)});N.ready.callbacks.push(F);return N};N.ready.callbacks=[];N.raise=function(R,Q){var P=Q?"Fatal error":"Error",M={color:"#fff",position:"absolute",top:0,left:0,zIndex:100000},F=function(T){var S='<div style="padding:4px;margin:0 0 2px;background:#'+(Q?"811":"222")+';">'+(Q?"<strong>"+P+": </strong>":"")+T+"</div>";w.each(g,function(){var U=this.$("errors"),V=this.$("target");if(!U.length){V.css("position","relative");U=this.addElement("errors").appendChild("target","errors").$("errors").css(M)}U.append(S)});if(!g.length){w("<div>").css(w.extend(M,{position:"fixed"})).append(S).appendTo(r().body)}};if(v){F(R);if(Q){throw new Error(P+": "+R)}}else{if(Q){if(p){return}p=true;Q=false;F("Gallery could not load.")}}};N.version=m;N.getLoadedThemes=function(){return w.map(A,function(F){return F.name})};N.requires=function(F,M){M=M||"You need to upgrade Galleria to version "+F+" to use one or more components.";if(N.version<F){N.raise(M,true)}return N};N.Picture=function(F){this.id=F||null;this.image=null;this.container=B.create("galleria-image");w(this.container).css({overflow:"hidden",position:"relative"});this.original={width:0,height:0};this.ready=false;this.isIframe=false};N.Picture.prototype={cache:{},show:function(){B.show(this.image)},hide:function(){B.moveOut(this.image)},clear:function(){this.image=null},isCached:function(F){return !!this.cache[F]},preload:function(F){w(new Image()).load((function(P,M){return function(){M[P]=P}}(F,this.cache))).attr("src",F)},load:function(F,X,V){if(typeof X=="function"){V=X;X=null}if(this.isIframe){var P="if"+new Date().getTime();var S=this.image=w("<iframe>",{src:F,frameborder:0,id:P,allowfullscreen:true,css:{visibility:"hidden"}})[0];if(X){w(S).css(X)}w(this.container).find("iframe,img").remove();this.container.appendChild(this.image);w("#"+P).load((function(Y,Z){return function(){D.setTimeout(function(){w(Y.image).css("visibility","visible");if(typeof Z=="function"){Z.call(Y,Y)}},10)}}(this,V)));return this.container}this.image=new Image();if(N.IE8){w(this.image).css("filter","inherit")}if(!N.IE&&!N.CHROME&&!N.SAFARI){w(this.image).css("image-rendering","optimizequality")}var M=false,T=false,W=w(this.container),Q=w(this.image),U=function(){if(!M){M=true;D.setTimeout((function(Y,Z){return function(){Y.attr("src",Z+(Z.indexOf("?")>-1?"&":"?")+B.timestamp())}}(w(this),F)),50)}else{if(j){w(this).attr("src",j)}else{N.raise("Image not found: "+F)}}},R=(function(Y,aa,Z){return function(){var ab=function(){w(this).off("load");Y.original=X||{height:this.height,width:this.width};if(N.HAS3D){this.style.MozTransform=this.style.webkitTransform="translate3d(0,0,0)"}W.append(this);Y.cache[Z]=Z;if(typeof aa=="function"){D.setTimeout(function(){aa.call(Y,Y)},1)}};if((!this.width||!this.height)){(function(ac){B.wait({until:function(){return ac.width&&ac.height},success:function(){ab.call(ac)},error:function(){if(!T){w(new Image()).load(R).attr("src",ac.src);T=true}else{N.raise("Could not extract width/height from image: "+ac.src+". Traced measures: width:"+ac.width+"px, height: "+ac.height+"px.")}},timeout:100})}(this))}else{ab.call(this)}}}(this,V,F));W.find("iframe,img").remove();Q.css("display","block");B.hide(this.image);w.each("minWidth minHeight maxWidth maxHeight".split(" "),function(Y,Z){Q.css(Z,(/min/.test(Z)?"0":"none"))});Q.load(R).on("error",U).attr("src",F);return this.container},scale:function(Y){var X=this;Y=w.extend({width:0,height:0,min:q,max:q,margin:0,complete:i,position:"center",crop:false,canvas:false,iframelimit:q},Y);if(this.isIframe){var R=Y.width,M=Y.height,T,Q;if(Y.iframelimit){var F=f.min(Y.iframelimit/R,Y.iframelimit/M);if(F<1){T=R*F;Q=M*F;w(this.image).css({top:M/2-Q/2,left:R/2-T/2,position:"absolute"})}else{w(this.image).css({top:0,left:0})}}w(this.image).width(T||R).height(Q||M).removeAttr("width").removeAttr("height");w(this.container).width(R).height(M);Y.complete.call(X,X);try{if(this.image.contentWindow){w(this.image.contentWindow).trigger("resize")}}catch(U){}return this.container}if(!this.image){return this.container}var P,V,W=w(X.container),S;B.wait({until:function(){P=Y.width||W.width()||B.parseValue(W.css("width"));V=Y.height||W.height()||B.parseValue(W.css("height"));return P&&V},success:function(){var ab=(P-Y.margin*2)/X.original.width,Z=(V-Y.margin*2)/X.original.height,aa=f.min(ab,Z),ae=f.max(ab,Z),ai={"true":ae,width:ab,height:Z,"false":aa,landscape:X.original.width>X.original.height?ae:aa,portrait:X.original.width<X.original.height?ae:aa},ac=ai[Y.crop.toString()],af="";if(Y.max){ac=f.min(Y.max,ac)}if(Y.min){ac=f.max(Y.min,ac)}w.each(["width","height"],function(al,ak){w(X.image)[ak](X[ak]=X.image[ak]=f.round(X.original[ak]*ac))});w(X.container).width(P).height(V);if(Y.canvas&&n){n.elem.width=X.width;n.elem.height=X.height;af=X.image.src+":"+X.width+"x"+X.height;X.image.src=n.cache[af]||(function(ak){n.context.drawImage(X.image,0,0,X.original.width*ac,X.original.height*ac);try{S=n.elem.toDataURL();n.length+=S.length;n.cache[ak]=S;return S}catch(al){return X.image.src}}(af))}var ad={},ah={},ag=function(ao,am,an){var al=0;if(/\%/.test(ao)){var ap=parseInt(ao,10)/100,ak=X.image[am]||w(X.image)[am]();al=f.ceil(ak*-1*ap+an*ap)}else{al=B.parseValue(ao)}return al},aj={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};w.each(Y.position.toLowerCase().split(" "),function(ak,al){if(al==="center"){al="50%"}ad[ak?"top":"left"]=al});w.each(ad,function(ak,al){if(aj.hasOwnProperty(al)){w.extend(ah,aj[al])}});ad=ad.top?w.extend(ad,ah):ah;ad=w.extend({top:"50%",left:"50%"},ad);w(X.image).css({position:"absolute",top:ag(ad.top,"height",V),left:ag(ad.left,"width",P)});X.show();X.ready=true;Y.complete.call(X,X)},error:function(){N.raise("Could not scale image: "+X.image.src)},timeout:1000});return this}};w.extend(w.easing,{galleria:function(M,P,F,R,Q){if((P/=Q/2)<1){return R/2*P*P*P+F}return R/2*((P-=2)*P*P+2)+F},galleriaIn:function(M,P,F,R,Q){return R*(P/=Q)*P+F},galleriaOut:function(M,P,F,R,Q){return -R*(P/=Q)*(P-2)+F}});N.Finger=(function(){var F=f.abs;var Q=N.HAS3D=(function(){var V=c.createElement("p"),W,T=["webkit","O","ms","Moz",""],U,S=0,R="transform";r().html.insertBefore(V,null);for(;T[S];S++){U=T[S]?T[S]+"Transform":R;if(V.style[U]!==undefined){V.style[U]="translate3d(1px,1px,1px)";W=w(V).css(T[S]?"-"+T[S].toLowerCase()+"-"+R:R)}}r().html.removeChild(V);return(W!==undefined&&W.length>0&&W!=="none")}());var P=(function(){var R="RequestAnimationFrame";return D.requestAnimationFrame||D["webkit"+R]||D["moz"+R]||D["o"+R]||D["ms"+R]||function(S){D.setTimeout(S,1000/60)}}());var M=function(U,T){this.config={start:0,duration:500,onchange:function(){},oncomplete:function(){},easing:function(W,X,V,Z,Y){return -Z*((X=X/Y-1)*X*X*X-1)+V}};this.easeout=function(W,X,V,Z,Y){return Z*((X=X/Y-1)*X*X*X*X+1)+V};if(!U.children.length){return}var S=this;w.extend(this.config,T);this.elem=U;this.child=U.children[0];this.to=this.pos=0;this.touching=false;this.start={};this.index=this.config.start;this.anim=0;this.easing=this.config.easing;if(!Q){this.child.style.position="absolute";this.elem.style.position="relative"}w.each(["ontouchstart","ontouchmove","ontouchend","setup"],function(V,W){S[W]=(function(X){return function(){X.apply(S,arguments)}}(S[W]))});this.setX=function(){var V=S.child.style;if(!Q){V.left=S.pos+"px";return}V.MozTransform=V.webkitTransform=V.transform="translate3d("+S.pos+"px,0,0)";return};w(U).on("touchstart",this.ontouchstart);w(D).on("resize",this.setup);w(D).on("orientationchange",this.setup);this.setup();(function R(){P(R);S.loop.call(S)}())};M.prototype={constructor:M,setup:function(){this.width=w(this.elem).width();this.length=f.ceil(w(this.child).width()/this.width);if(this.index!==0){this.index=f.max(0,f.min(this.index,this.length-1));this.pos=this.to=-this.width*this.index}},setPosition:function(R){this.pos=R;this.to=R},ontouchstart:function(R){var S=R.originalEvent.touches;this.start={pageX:S[0].pageX,pageY:S[0].pageY,time:+new Date()};this.isScrolling=null;this.touching=true;this.deltaX=0;L.on("touchmove",this.ontouchmove);L.on("touchend",this.ontouchend)},ontouchmove:function(R){var S=R.originalEvent.touches;if(S&&S.length>1||R.scale&&R.scale!==1){return}this.deltaX=S[0].pageX-this.start.pageX;if(this.isScrolling===null){this.isScrolling=!!(this.isScrolling||f.abs(this.deltaX)<f.abs(S[0].pageY-this.start.pageY))}if(!this.isScrolling){R.preventDefault();this.deltaX/=((!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0)?(f.abs(this.deltaX)/this.width+1.8):1);this.to=this.deltaX-this.index*this.width}R.stopPropagation()},ontouchend:function(T){this.touching=false;var S=+new Date()-this.start.time<250&&f.abs(this.deltaX)>40||f.abs(this.deltaX)>this.width/2,R=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;if(!this.isScrolling){this.show(this.index+(S&&!R?(this.deltaX<0?1:-1):0))}L.off("touchmove",this.ontouchmove);L.off("touchend",this.ontouchend)},show:function(R){if(R!=this.index){this.config.onchange.call(this,R)}else{this.to=-(R*this.width)}},moveTo:function(R){if(R!=this.index){this.pos=this.to=-(R*this.width);this.index=R}},loop:function(){var U=this.to-this.pos,S=1;if(this.width&&U){S=f.max(0.5,f.min(1.5,f.abs(U/this.width)))}if(this.touching||f.abs(U)<=1){this.pos=this.to;U=0;if(this.anim&&!this.touching){this.config.oncomplete(this.index)}this.anim=0;this.easing=this.config.easing}else{if(!this.anim){this.anim={start:this.pos,time:+new Date(),distance:U,factor:S,destination:this.to}}var R=+new Date()-this.anim.time;var T=this.config.duration*this.anim.factor;if(R>T||this.anim.destination!=this.to){this.anim=0;this.easing=this.easeout;return}this.pos=this.easing(null,R,this.anim.start,this.anim.distance,T)}this.setX()}};return M}());w.fn.galleria=function(M){var F=this.selector;if(!w(this).length){w(function(){if(w(F).length){w(F).galleria(M)}else{N.utils.wait({until:function(){return w(F).length},success:function(){w(F).galleria(M)},error:function(){N.raise('Init failed: Galleria could not find the element "'+F+'".')},timeout:5000})}});return this}return this.each(function(){if(w.data(this,"galleria")){w.data(this,"galleria").destroy();w(this).find("*").hide()}w.data(this,"galleria",new N().init(this,M))})};if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=N}else{D.Galleria=N;if(typeof define==="function"&&define.amd){define("galleria",["jquery"],function(){return N})}}}(jQuery,this));